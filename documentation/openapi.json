{"openapi":"3.1.0","info":{"title":"StealthGuardian API","description":"This is the StealthGuardian API with API key authentication","version":"1.0.0"},"paths":{"/api/version":{"get":{"tags":["Middleware"],"summary":"Display version Information","description":"Returns the tool's version","operationId":"read_root_api_version_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/middlewareconfiguration":{"get":{"tags":["Middleware"],"summary":"Return Middleware Configuration","description":"Returns all configuration settings of the Middleware","operationId":"get_all_configurations_api_middlewareconfiguration_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ConfigurationEntry"},"title":"Response Get All Configurations Api Middlewareconfiguration Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/middlewareconfiguration/update":{"post":{"tags":["Middleware"],"summary":"Update Middleware/Environment Settings","description":"Updates a Setting in the Middleware/Environment Configuration","operationId":"update_middleware_configuration_api_middlewareconfiguration_update_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateConfigurationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/middlewareconfiguration/add":{"post":{"tags":["Middleware"],"summary":"Add Middleware/Environment Setting","description":"Adds a new Setting to the Middleware Configuration","operationId":"new_middleware_configuration_api_middlewareconfiguration_add_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewConfigurationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/endpoints":{"get":{"tags":["Endpoint"],"summary":"Return Endpoints","description":"Returns all Endpoints","operationId":"read_endpoints_api_endpoints_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Endpoint"},"title":"Response Read Endpoints Api Endpoints Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/generate-uuid":{"get":{"tags":["Endpoint"],"summary":"Returns a new UUID for Agent registration","description":"Returns a UUID which will be the StealthGuardianEndpointAPIKey of an Agent","operationId":"generate_uuid_api_generate_uuid_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UUIDResponse"}}}}}}},"/api/activate":{"post":{"tags":["Endpoint"],"summary":"Activates an Endpoint","description":"Activates an endpoint with an StealthGuardianEndpointAPIKey","operationId":"activate_endpoint_api_activate_post","parameters":[{"name":"StealthGuardianEndpointAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianendpointapikey"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActivationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/get-configuration":{"post":{"tags":["Endpoint"],"summary":"Get Configuration for an Endpoint","description":"Returns the configuration for a specific endpoint","operationId":"get_configuration_api_get_configuration_post","parameters":[{"name":"StealthGuardianEndpointAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianendpointapikey"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfigurationRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfigurationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/endpoints/assign":{"post":{"tags":["Endpoint"],"summary":"Assign Beacon to Agent","description":"Mapping between a Beacon and Agent for Log correlation","operationId":"update_endpoint_reference_api_endpoints_assign_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetReferenceBeaconRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/endpoints/assignscanprofile":{"post":{"tags":["Endpoint"],"summary":"Assign Scan Profile to Agent","description":"Assign a Scan Profile to an Agent","operationId":"update_scan_profile_api_endpoints_assignscanprofile_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetScanProfileAgentRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/beacons":{"get":{"tags":["Beacon"],"summary":"Return all Beacons","description":"Return all Beacons","operationId":"read_beacons_api_beacons_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Beacon"},"title":"Response Read Beacons Api Beacons Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/beacons/add":{"post":{"tags":["Beacon"],"summary":"New Beacon","description":"Register a new Beacon to the Middleware so that it can be assigned to an Endpoint/Agent","operationId":"new_agentlog_api_beacons_add_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewBeaconRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agentlogs":{"get":{"tags":["Agent"],"summary":"Return all Agent Logs","description":"Returns all Logs send by Agents","operationId":"get_all_agentlogs_api_agentlogs_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AgentEventEntry"},"title":"Response Get All Agentlogs Api Agentlogs Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agentlogs/log/{logcheck}":{"get":{"tags":["Agent"],"summary":"Return a specific logs","description":"Returns a specific log of an Agent, filtered by uuid of log entry","operationId":"get_agentlog_by_id_api_agentlogs_log__logcheck__get","parameters":[{"name":"logcheck","in":"path","required":true,"schema":{"type":"string","title":"Logcheck"}},{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AgentEventEntry"},"title":"Response Get Agentlog By Id Api Agentlogs Log  Logcheck  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agentlogs/add":{"post":{"tags":["Agent"],"summary":"Adds log for an Agent","description":"Adds a new log entry for an Agent","operationId":"new_agentlog_api_agentlogs_add_post","parameters":[{"name":"StealthGuardianEndpointAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianendpointapikey"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewAgentLogRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agentlogs/update":{"post":{"tags":["Agent"],"summary":"Change notified value","description":"Can be used to change the notified column of a log entry to mark it after informing the user","operationId":"update_agentlog_api_agentlogs_update_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateLogRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agentlogs/{notified}":{"get":{"tags":["Agent"],"summary":"Filter for notified column of log entries","description":"Returns all logs having notified set to a specific value","operationId":"get_agentlog_by_status_api_agentlogs__notified__get","parameters":[{"name":"notified","in":"path","required":true,"schema":{"type":"string","title":"Notified"}},{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agentlogs/filter/{sourceBeacon}":{"get":{"tags":["Agent"],"summary":"Filter for specific beacon log entries","description":"Returns all log entries of a specific beacon","operationId":"get_agentlog_by_sourceBeacon_api_agentlogs_filter__sourceBeacon__get","parameters":[{"name":"sourceBeacon","in":"path","required":true,"schema":{"type":"string","title":"Sourcebeacon"}},{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks":{"get":{"tags":["Beacon"],"summary":"Return all Beacon Tasks","description":"Returns all Beacon Tasks","operationId":"get_all_tasks_api_tasks_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskEntry"},"title":"Response Get All Tasks Api Tasks Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/add/withfile":{"post":{"tags":["Beacon"],"summary":"Upload a file with a reference","description":"Endpoint to upload a file and a filereference using multipart form data","operationId":"upload_file_api_tasks_add_withfile_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_api_tasks_add_withfile_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/add":{"post":{"tags":["Beacon"],"summary":"Add a new Beacon Task","description":"Adds a new Tasks to a Beacon which will be executed against the reference","operationId":"new_script_api_tasks_add_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewTaskRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/{source}":{"get":{"tags":["Beacon"],"summary":"Return all Tasks filtered by a source","description":"Returns all Tasks filtered by a source, which is the adversary tool","operationId":"get_tasks_by_source_and_status_api_tasks__source__get","parameters":[{"name":"source","in":"path","required":true,"schema":{"type":"string","title":"Source"}},{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskEntry"},"title":"Response Get Tasks By Source And Status Api Tasks  Source  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/filter/{sourceBeacon}":{"get":{"tags":["Beacon"],"summary":"Return all Tasks filtered by sourceBeacon","description":"Returns all Tasks filtered by a sourceBeacon","operationId":"get_tasks_by_sourceBeacon_api_tasks_filter__sourceBeacon__get","parameters":[{"name":"sourceBeacon","in":"path","required":true,"schema":{"type":"string","title":"Sourcebeacon"}},{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskEntry"},"title":"Response Get Tasks By Sourcebeacon Api Tasks Filter  Sourcebeacon  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/update":{"post":{"tags":["Beacon"],"summary":"Updates status of a Task","description":"Updates status of a Task after it was processed","operationId":"update_task_Status_api_tasks_update_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTaskRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agenttasks":{"get":{"tags":["Agent"],"summary":"Return all Tasks of all Agents","description":"Returns all Tasks of all Agents","operationId":"get_all_agenttasks_api_agenttasks_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AgentTaskEntry"},"title":"Response Get All Agenttasks Api Agenttasks Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agenttask/add":{"post":{"tags":["Agent"],"summary":"Add new Agent Task","description":"Adds a new Tasks to the Agent which is then collected by the Agent","operationId":"new_agenttask_api_agenttask_add_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewAgentTaskRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agenttask/updateconfig":{"post":{"tags":["Agent"],"summary":"Let the agent update its content","description":"Initiate config change to the Agent","operationId":"new_agentconfig_api_agenttask_updateconfig_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentUpdateConfig"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agenttask/update":{"post":{"tags":["Agent"],"summary":"Change executed value","description":"Can be used to change the executed column of a task entry to mark it as executed","operationId":"update_agenttask_api_agenttask_update_post","parameters":[{"name":"StealthGuardianEndpointAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianendpointapikey"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateAgentTaskRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agenttask/{agentid}":{"get":{"tags":["Agent"],"summary":"Filter Tasks for an Agent","description":"Filter Agent Tasks for a specific Agent uuid","operationId":"get_agenttask_by_agentuuid_api_agenttask__agentid__get","parameters":[{"name":"agentid","in":"path","required":true,"schema":{"type":"string","title":"Agentid"}},{"name":"StealthGuardianEndpointAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianendpointapikey"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AgentTaskRequestCommand"},"title":"Response Get Agenttask By Agentuuid Api Agenttask  Agentid  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scanmodules":{"get":{"tags":["Script"],"summary":"Return Scan Modules","description":"Returns all configured Scan Modules","operationId":"get_scanmodules_api_scanmodules_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ModuleGroup"},"title":"Response Get Scanmodules Api Scanmodules Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scanmodules/update":{"post":{"tags":["Script"],"summary":"Update a Scan Module","description":"Can be used to add Scripts to a Scan Module","operationId":"update_scanprofile_api_scanmodules_update_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateScanProfileRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scanmodules/add":{"post":{"tags":["Script"],"summary":"Add a Scan Module","description":"Can be used to add a Scan Module","operationId":"add_scan_profile_api_scanmodules_add_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewScanProfileRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scripts":{"get":{"tags":["Script"],"summary":"Return all Scan Scripts","description":"Returns all available Scan Scripts","operationId":"get_scripts_api_scripts_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Module"},"title":"Response Get Scripts Api Scripts Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/scripts/update":{"post":{"tags":["Script"],"summary":"Update a Scan Script","description":"Can be used to update an existing Scan Script","operationId":"update_script_api_scripts_update_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateScriptRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/script/add":{"post":{"tags":["Script"],"summary":"Add a Scan Script","description":"Can be used to add a Scan Script","operationId":"new_script_api_script_add_post","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewScriptRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"tags":["UI"],"summary":"Login Page","description":"Displays the Login Page of the application","operationId":"login_page__get","responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}}}}},"/login":{"post":{"tags":["UI"],"summary":"Authentication","description":"Verifies authentication","operationId":"login_login_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_login_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/logout":{"get":{"tags":["UI"],"summary":"Logout","description":"Clears the authentication cookie","operationId":"logout_logout_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/main":{"get":{"tags":["UI"],"summary":"Authenticated area of the application","description":"Authenticated part of the application","operationId":"main_page_main_get","parameters":[{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/template/{page_name}":{"get":{"tags":["UI"],"summary":"Load content of a page","description":"Dynamic loading of authenticated pages in the application","operationId":"get_template_template__page_name__get","parameters":[{"name":"page_name","in":"path","required":true,"schema":{"type":"string","title":"Page Name"}},{"name":"StealthGuardianAPIKey","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stealthguardianapikey"}},{"name":"access_token","in":"cookie","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}}],"responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ActivationRequest":{"properties":{"uuid":{"type":"string","title":"Uuid"},"name":{"type":"string","title":"Name"}},"type":"object","required":["uuid","name"],"title":"ActivationRequest"},"AgentEventEntry":{"properties":{"id":{"type":"integer","title":"Id"},"logcheck":{"type":"string","title":"Logcheck"},"agentuuid":{"type":"string","title":"Agentuuid"},"timestamp":{"type":"string","title":"Timestamp"},"status":{"type":"string","title":"Status"},"raw_event":{"type":"string","title":"Raw Event"},"check_type":{"type":"string","title":"Check Type"},"module_uuid":{"type":"string","title":"Module Uuid"},"executed_module":{"type":"integer","title":"Executed Module"},"notified":{"type":"integer","title":"Notified"}},"type":"object","required":["id","logcheck","agentuuid","timestamp","status","raw_event","check_type","module_uuid","executed_module","notified"],"title":"AgentEventEntry"},"AgentTaskEntry":{"properties":{"id":{"type":"integer","title":"Id"},"timestamp":{"type":"string","title":"Timestamp"},"agentuuid":{"type":"string","title":"Agentuuid"},"command":{"type":"string","title":"Command"},"executed":{"type":"integer","title":"Executed"}},"type":"object","required":["id","timestamp","agentuuid","command","executed"],"title":"AgentTaskEntry"},"AgentTaskRequestCommand":{"properties":{"id":{"type":"integer","title":"Id"},"command":{"type":"string","title":"Command"}},"type":"object","required":["id","command"],"title":"AgentTaskRequestCommand"},"AgentUpdateConfig":{"properties":{"agentuuid":{"type":"string","title":"Agentuuid"}},"type":"object","required":["agentuuid"],"title":"AgentUpdateConfig"},"Beacon":{"properties":{"id":{"type":"integer","title":"Id"},"uuid":{"type":"string","title":"Uuid"},"buid":{"type":"string","title":"Buid"},"name":{"type":"string","title":"Name"},"source":{"type":"string","title":"Source"},"status":{"type":"string","title":"Status"}},"type":"object","required":["id","uuid","buid","name","source","status"],"title":"Beacon"},"Body_login_login_post":{"properties":{"api_key":{"type":"string","title":"Api Key"}},"type":"object","required":["api_key"],"title":"Body_login_login_post"},"Body_upload_file_api_tasks_add_withfile_post":{"properties":{"source":{"type":"string","title":"Source"},"sourceBeacon":{"type":"string","title":"Sourcebeacon"},"targetBeacon":{"type":"string","title":"Targetbeacon"},"command":{"type":"string","title":"Command"},"additionalcomandinfos":{"type":"string","format":"binary","title":"Additionalcomandinfos"}},"type":"object","required":["source","sourceBeacon","targetBeacon","command","additionalcomandinfos"],"title":"Body_upload_file_api_tasks_add_withfile_post"},"ConfigurationEntry":{"properties":{"id":{"type":"integer","title":"Id"},"key":{"type":"string","title":"Key"},"value":{"type":"string","title":"Value"}},"type":"object","required":["id","key","value"],"title":"ConfigurationEntry"},"ConfigurationRequest":{"properties":{"uuid":{"type":"string","title":"Uuid"}},"type":"object","required":["uuid"],"title":"ConfigurationRequest"},"ConfigurationResponse":{"properties":{"system":{"type":"string","title":"System"},"endpoint":{"type":"string","title":"Endpoint"},"port":{"type":"integer","title":"Port"},"modules":{"items":{"$ref":"#/components/schemas/ScanModule"},"type":"array","title":"Modules"},"uuid":{"type":"string","title":"Uuid"}},"type":"object","required":["system","endpoint","port","modules","uuid"],"title":"ConfigurationResponse"},"Endpoint":{"properties":{"id":{"type":"integer","title":"Id"},"uuid":{"type":"string","title":"Uuid"},"name":{"type":"string","title":"Name"},"activated":{"type":"integer","title":"Activated"},"agentmodules":{"type":"integer","title":"Agentmodules"},"referenceBeacon":{"type":"string","title":"Referencebeacon"}},"type":"object","required":["id","uuid","name","activated","agentmodules","referenceBeacon"],"title":"Endpoint"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Module":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"script":{"type":"string","title":"Script"}},"type":"object","required":["id","name","script"],"title":"Module"},"ModuleGroup":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"entries":{"items":{"$ref":"#/components/schemas/ModuleGroupEntry"},"type":"array","title":"Entries"}},"type":"object","required":["id","name","entries"],"title":"ModuleGroup"},"ModuleGroupEntry":{"properties":{"id":{"type":"integer","title":"Id"},"module_name":{"type":"string","title":"Module Name"}},"type":"object","required":["id","module_name"],"title":"ModuleGroupEntry"},"NewAgentLogRequest":{"properties":{"agentuuid":{"type":"string","title":"Agentuuid"},"status":{"type":"string","enum":["detected","undetected"],"title":"Status"},"raw_event":{"type":"string","title":"Raw Event"},"check_type":{"type":"string","title":"Check Type"},"module_uuid":{"type":"string","title":"Module Uuid"},"executed_module":{"type":"integer","title":"Executed Module"}},"type":"object","required":["agentuuid","status","raw_event","check_type","module_uuid","executed_module"],"title":"NewAgentLogRequest"},"NewAgentTaskRequest":{"properties":{"targetBeacon":{"type":"string","title":"Targetbeacon"},"command":{"type":"string","title":"Command"}},"type":"object","required":["targetBeacon","command"],"title":"NewAgentTaskRequest"},"NewBeaconRequest":{"properties":{"buid":{"type":"string","title":"Buid"},"name":{"type":"string","title":"Name"},"source":{"type":"string","title":"Source"}},"type":"object","required":["buid","name","source"],"title":"NewBeaconRequest"},"NewConfigurationRequest":{"properties":{"key":{"type":"string","title":"Key"},"value":{"type":"string","title":"Value"}},"type":"object","required":["key","value"],"title":"NewConfigurationRequest"},"NewScanProfileEntry":{"properties":{"module_id":{"type":"integer","title":"Module Id"}},"type":"object","required":["module_id"],"title":"NewScanProfileEntry"},"NewScanProfileRequest":{"properties":{"name":{"type":"string","title":"Name"},"entries":{"items":{"$ref":"#/components/schemas/NewScanProfileEntry"},"type":"array","title":"Entries"}},"type":"object","required":["name","entries"],"title":"NewScanProfileRequest"},"NewScriptRequest":{"properties":{"name":{"type":"string","title":"Name"},"script":{"type":"string","title":"Script"}},"type":"object","required":["name","script"],"title":"NewScriptRequest"},"NewTaskRequest":{"properties":{"source":{"type":"string","title":"Source"},"sourceBeacon":{"type":"string","title":"Sourcebeacon"},"targetBeacon":{"type":"string","title":"Targetbeacon"},"command":{"type":"string","title":"Command"}},"type":"object","required":["source","sourceBeacon","targetBeacon","command"],"title":"NewTaskRequest"},"ScanModule":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"script":{"type":"string","title":"Script"}},"type":"object","required":["id","name","script"],"title":"ScanModule"},"SetReferenceBeaconRequest":{"properties":{"agentUUID":{"type":"string","title":"Agentuuid"},"beaconUUID":{"type":"string","title":"Beaconuuid"}},"type":"object","required":["agentUUID","beaconUUID"],"title":"SetReferenceBeaconRequest"},"SetScanProfileAgentRequest":{"properties":{"agentUUID":{"type":"string","title":"Agentuuid"},"scanProfileId":{"type":"integer","title":"Scanprofileid"}},"type":"object","required":["agentUUID","scanProfileId"],"title":"SetScanProfileAgentRequest"},"TaskEntry":{"properties":{"id":{"type":"integer","title":"Id"},"taskid":{"type":"string","title":"Taskid"},"timestamp":{"type":"string","title":"Timestamp"},"source":{"type":"string","title":"Source"},"sourceBeacon":{"type":"string","title":"Sourcebeacon"},"targetBeacon":{"type":"string","title":"Targetbeacon"},"command":{"type":"string","title":"Command"},"status":{"type":"string","title":"Status"},"result":{"type":"string","title":"Result"},"additionalcomandinfos":{"type":"string","format":"binary","title":"Additionalcomandinfos"}},"type":"object","required":["id","taskid","timestamp","source","sourceBeacon","targetBeacon","command","status","result","additionalcomandinfos"],"title":"TaskEntry"},"UUIDResponse":{"properties":{"uuid":{"type":"string","title":"Uuid"}},"type":"object","required":["uuid"],"title":"UUIDResponse"},"UpdateAgentTaskRequest":{"properties":{"id":{"type":"integer","title":"Id"},"executed":{"type":"integer","title":"Executed"}},"type":"object","required":["id","executed"],"title":"UpdateAgentTaskRequest"},"UpdateConfigurationRequest":{"properties":{"id":{"type":"integer","title":"Id"},"value":{"type":"string","title":"Value"}},"type":"object","required":["id","value"],"title":"UpdateConfigurationRequest"},"UpdateLogRequest":{"properties":{"logcheck":{"type":"string","title":"Logcheck"},"notified":{"type":"integer","title":"Notified"}},"type":"object","required":["logcheck","notified"],"title":"UpdateLogRequest"},"UpdateScanProfileRequest":{"properties":{"module_id":{"type":"integer","title":"Module Id"},"profile_id":{"type":"integer","title":"Profile Id"}},"type":"object","required":["module_id","profile_id"],"title":"UpdateScanProfileRequest"},"UpdateScriptRequest":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"script":{"type":"string","title":"Script"}},"type":"object","required":["id","name","script"],"title":"UpdateScriptRequest"},"UpdateTaskRequest":{"properties":{"taskid":{"type":"string","title":"Taskid"},"status":{"type":"string","enum":["queued","executed","completed","notified"],"title":"Status"},"result":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Result"}},"type":"object","required":["taskid","status"],"title":"UpdateTaskRequest"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"StealthGuardianAPIKey":{"type":"apiKey","name":"StealthGuardianAPIKey","in":"header"},"StealthGuardianEndpointAPIKey":{"type":"apiKey","name":"StealthGuardianEndpointAPIKey","in":"header"}}},"tags":[{"name":"Endpoint","description":"Agent Registration and Configuration"},{"name":"Agent","description":"Agent Control, Sending Logs and Retrieving Logs"},{"name":"Beacon","description":"Beacon Control, Sending Logs and Retrieving Logs"},{"name":"Middleware","description":"Control over Middleware/Environment Settings"},{"name":"Script","description":"Adding new scripts and script modules to the application that can be deployed to Agents"},{"name":"UI","description":"Graphical UI Logic"}],"security":[{"StealthGuardianAPIKey":[]},{"StealthGuardianEndpointAPIKey":[]}]}